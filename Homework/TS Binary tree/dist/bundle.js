(()=>{"use strict";const e=function(e,t){this.data=e,this.key=t,this.data=e,this.key=t,this.leftChild=null,this.rightChild=null,this.depthLevel=0},t=function(){function t(){this.root=null}return t.prototype.addNode=function(t,i){var r=new e(i,t);null===this.root?this.root=r:this.recurceAddNode(r,this.root)},t.prototype.recurceAddNode=function(e,t){if(e.depthLevel++,e.depthLevel>4)alert("Maximum tree depth reached!");else if(e.key<t.key)null===t.leftChild?t.leftChild=e:this.recurceAddNode(e,t.leftChild);else{if(!(e.key>t.key))return void alert("Such a key already exists!");null===t.rightChild?t.rightChild=e:this.recurceAddNode(e,t.rightChild)}},t.prototype.removeHelper=function(e,t){this.removeNode(this.root,e)},t.prototype.removeNode=function(e,t){if(null===e)return null;if(t<e.key)return e.leftChild=this.removeNode(e.leftChild,t),e;if(t>e.key)return e.rightChild=this.removeNode(e.rightChild,t),e;if(null===e.leftChild&&null===e.rightChild)return null;if(null===e.leftChild)return e.rightChild;if(null===e.rightChild)return e.leftChild;var i=this.searchMinNode(e.rightChild);return e.key=i.key,e.rightChild=this.removeNode(e.rightChild,i.key),e},t.prototype.searchMinNode=function(e){return null===e.leftChild?e:this.searchMinNode(e.leftChild)},t.prototype.searchNodeByKey=function(e,t){try{if(e===t.key)return t;if(e>t.key)return this.searchNodeByKey(e,t.rightChild);if(e<t.key)return this.searchNodeByKey(e,t.leftChild)}catch(e){return alert("There is no such key!"),null}},t.prototype.isHaveRoot=function(e){if(null===e.root)return alert("The tree is not initialized!"),null},t}(),i=function(){function e(){this.spreadByDepth=250,this.xPosFirsrNode=window.innerWidth/2-60,this.yPosArr=[80,160,240,320,400]}return e.prototype.drawTree=function(e){var t;t=this.createPosArray(this.xPosFirsrNode,this.yPosArr,e,[],this.spreadByDepth);var i=document.getElementById("canvas-output"),r=i.getContext("2d");i.width=window.innerWidth,i.height=window.innerHeight;for(var n=0;n<t.length;)r.lineWidth=2,r.strokeStyle="#ab",r.strokeRect(t[n+1],t[n+2],60,30),r.font="20px Georgia",r.textAlign="center",r.fillText(""+t[n],t[n+1]+30,t[n+2]+15),n+=3},e.prototype.createPosArray=function(e,t,i,r,n){return null!==i&&(r.push(i.key,e,t[i.depthLevel]),this.createPosArray(e-n,t,i.leftChild,r,n/2),this.createPosArray(e+n,t,i.rightChild,r,n/2)),r},e}();var r=new t,n=new i,l="entry-field__key",o="entry-field__ext-key",d="entry-field__delete-key";function h(e){var t=Number(document.getElementById(e).value);return t>50||t<0||t%1>0||Number.isNaN(t)?(alert("Invalid key value!"),null):0===t?(alert("Missing value in key field!"),null):t}window.addNode=function(){var e=h(l);if(null!==e){var t=document.getElementById("entry-field__data").value;0!==t.length?t.length>10?alert("Invalid data field length!"):(r.addNode(e,t),document.getElementById("entry-field__data").value="",document.getElementById(l).value=""):alert("Missing value in data field!")}},window.extractingNode=function(){if(null!==r.isHaveRoot(r)){var e=h(o);if(null!==e){var t=r.searchNodeByKey(e,r.root);null!==t&&(t.data,document.getElementById("output-field__ext-key").innerHTML="Data: "+t.data,document.getElementById(o).value="")}}},window.deleteNode=function(){if(null!==r.isHaveRoot(r)){var e=h(d);null!==e&&(r.removeHelper(e,r.root),document.getElementById(d).value="")}},window.outputTree=function(){null!==r.isHaveRoot(r)&&n.drawTree(r.root)},window.clearTree=function(){if(null!==r.isHaveRoot(r)){var e=document.getElementById("canvas-output");e.getContext("2d").clearRect(0,0,e.width,e.height),r.root=null}},document.addEventListener("DOMContentLoaded",(function(){alert("- Maximum tree depth (including root): 5 nodes.\n- Maximum number of characters for data field: 10 characters.\n- Keys can only be integers with a value of no more than 50.\n")}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaW5hcnktdHJlZS8uL3NyYy90cmVlLW5vZGUudHMiLCJ3ZWJwYWNrOi8vYmluYXJ5LXRyZWUvLi9zcmMvYmluYXJ5LXRyZWUudHMiLCJ3ZWJwYWNrOi8vYmluYXJ5LXRyZWUvLi9zcmMvZHJhdy1oZWxwZXIudHMiLCJ3ZWJwYWNrOi8vYmluYXJ5LXRyZWUvLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOlsiZGF0YSIsImtleSIsInRoaXMiLCJsZWZ0Q2hpbGQiLCJyaWdodENoaWxkIiwiZGVwdGhMZXZlbCIsInJvb3QiLCJhZGROb2RlIiwibmV3Tm9kZSIsInJlY3VyY2VBZGROb2RlIiwiYWxlcnQiLCJyZW1vdmVIZWxwZXIiLCJyZW1vdmVOb2RlIiwic2VhcmNoTWluTm9kZSIsInNlYXJjaE5vZGVCeUtleSIsImVyciIsImlzSGF2ZVJvb3QiLCJiaW5hcnlUcmVlIiwic3ByZWFkQnlEZXB0aCIsInhQb3NGaXJzck5vZGUiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwieVBvc0FyciIsImRyYXdUcmVlIiwicG9zQXJyYXkiLCJjcmVhdGVQb3NBcnJheSIsImNhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjdHgiLCJnZXRDb250ZXh0Iiwid2lkdGgiLCJoZWlnaHQiLCJpbm5lckhlaWdodCIsImkiLCJsZW5ndGgiLCJsaW5lV2lkdGgiLCJzdHJva2VTdHlsZSIsInN0cm9rZVJlY3QiLCJmb250IiwidGV4dEFsaWduIiwiZmlsbFRleHQiLCJwdXNoIiwiZHJhd0hlbHBlciIsIkFERF9LRVlfSUQiLCJFWFRSX0tFWV9JRCIsIkRFTF9LRVlfSUQiLCJrZXlIZWxwZXIiLCJpZCIsIk51bWJlciIsInZhbHVlIiwiaXNOYU4iLCJleHRyYWN0aW5nTm9kZSIsInJlcXVpcmVkTm9kZSIsImlubmVySFRNTCIsImRlbGV0ZU5vZGUiLCJvdXRwdXRUcmVlIiwiY2xlYXJUcmVlIiwiY2xlYXJSZWN0IiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJt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Q2pELE1BQU0sc0wiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHJlZU5vZGU8VD4ge1xyXG4gICAgbGVmdENoaWxkOiBUcmVlTm9kZTxUPiB8IG51bGw7XHJcbiAgICByaWdodENoaWxkOiBUcmVlTm9kZTxUPiB8IG51bGw7XHJcbiAgICBkZXB0aExldmVsOiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKHB1YmxpYyBkYXRhOiBULCBwdWJsaWMga2V5OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMua2V5ID0ga2V5O1xyXG4gICAgICAgIHRoaXMubGVmdENoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnJpZ2h0Q2hpbGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGVwdGhMZXZlbCA9IDA7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFRyZWVOb2RlIGZyb20gXCIuL3RyZWUtbm9kZVwiO1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJpbmFyeVRyZWUge1xyXG4gICAgcm9vdDogVHJlZU5vZGU8c3RyaW5nPiB8IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMucm9vdCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFkZE5vZGUoa2V5OiBudW1iZXIsIGRhdGE6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IG5ld05vZGU6IFRyZWVOb2RlPHN0cmluZz4gPSBuZXcgVHJlZU5vZGUoZGF0YSwga2V5KTtcclxuICAgICAgICBpZiAodGhpcy5yb290ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9vdCA9IG5ld05vZGU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWN1cmNlQWRkTm9kZShuZXdOb2RlLCB0aGlzLnJvb3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlY3VyY2VBZGROb2RlKG5ld05vZGU6IFRyZWVOb2RlPHN0cmluZz4sIHJvb3Q6IFRyZWVOb2RlPHN0cmluZz4pOiB2b2lkIHtcclxuICAgICAgICBuZXdOb2RlLmRlcHRoTGV2ZWwrKztcclxuICAgICAgICBpZiAobmV3Tm9kZS5kZXB0aExldmVsID4gNCkge1xyXG4gICAgICAgICAgICBhbGVydChcIk1heGltdW0gdHJlZSBkZXB0aCByZWFjaGVkIVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmV3Tm9kZS5rZXkgPCByb290LmtleSkge1xyXG4gICAgICAgICAgICByb290LmxlZnRDaGlsZCA9PT0gbnVsbCA/IHJvb3QubGVmdENoaWxkID0gbmV3Tm9kZSA6IHRoaXMucmVjdXJjZUFkZE5vZGUobmV3Tm9kZSwgcm9vdC5sZWZ0Q2hpbGQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmV3Tm9kZS5rZXkgPiByb290LmtleSkge1xyXG4gICAgICAgICAgICByb290LnJpZ2h0Q2hpbGQgPT09IG51bGwgPyByb290LnJpZ2h0Q2hpbGQgPSBuZXdOb2RlIDogdGhpcy5yZWN1cmNlQWRkTm9kZShuZXdOb2RlLCByb290LnJpZ2h0Q2hpbGQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwiU3VjaCBhIGtleSBhbHJlYWR5IGV4aXN0cyFcIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbW92ZUhlbHBlciAoa2V5OiBudW1iZXIsIHJvb3Q6IFRyZWVOb2RlPHN0cmluZz4pOiB2b2lkIHtcclxuICAgICAgICByb290ID0gdGhpcy5yZW1vdmVOb2RlKHRoaXMucm9vdCwga2V5KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlbW92ZU5vZGUocm9vdDogVHJlZU5vZGU8c3RyaW5nPiwga2V5OiBudW1iZXIpOiBUcmVlTm9kZTxzdHJpbmc+IHtcclxuICAgICAgICBpZiAocm9vdCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGtleSA8IHJvb3Qua2V5KSB7XHJcbiAgICAgICAgICAgIHJvb3QubGVmdENoaWxkID0gdGhpcy5yZW1vdmVOb2RlKHJvb3QubGVmdENoaWxkLCBrZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gcm9vdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGtleSA+IHJvb3Qua2V5KSB7XHJcbiAgICAgICAgICAgIHJvb3QucmlnaHRDaGlsZCA9IHRoaXMucmVtb3ZlTm9kZShyb290LnJpZ2h0Q2hpbGQsIGtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiByb290O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm9vdC5sZWZ0Q2hpbGQgPT09IG51bGwgJiYgcm9vdC5yaWdodENoaWxkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJvb3QgPSBudWxsO1xyXG4gICAgICAgICAgICByZXR1cm4gcm9vdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJvb3QubGVmdENoaWxkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJvb3QgPSByb290LnJpZ2h0Q2hpbGQ7XHJcbiAgICAgICAgICAgIHJldHVybiByb290O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm9vdC5yaWdodENoaWxkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJvb3QgPSByb290LmxlZnRDaGlsZDtcclxuICAgICAgICAgICAgcmV0dXJuIHJvb3Q7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBuZXdOb2RlID0gdGhpcy5zZWFyY2hNaW5Ob2RlKHJvb3QucmlnaHRDaGlsZCk7XHJcbiAgICAgICAgcm9vdC5rZXkgPSBuZXdOb2RlLmtleTtcclxuICAgICAgICByb290LnJpZ2h0Q2hpbGQgPSB0aGlzLnJlbW92ZU5vZGUocm9vdC5yaWdodENoaWxkLCBuZXdOb2RlLmtleSk7XHJcbiAgICAgICAgcmV0dXJuIHJvb3Q7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2VhcmNoTWluTm9kZShyb290OiBUcmVlTm9kZTxzdHJpbmc+KTogVHJlZU5vZGU8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKHJvb3QubGVmdENoaWxkID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByb290O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5zZWFyY2hNaW5Ob2RlKHJvb3QubGVmdENoaWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2VhcmNoTm9kZUJ5S2V5KGtleTogbnVtYmVyLCByb290OiBUcmVlTm9kZTxzdHJpbmc+KTogVHJlZU5vZGU8c3RyaW5nPiB8IG51bGwge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHJvb3Qua2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9vdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoa2V5ID4gcm9vdC5rZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlYXJjaE5vZGVCeUtleShrZXksIHJvb3QucmlnaHRDaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGtleSA8IHJvb3Qua2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZWFyY2hOb2RlQnlLZXkoa2V5LCByb290LmxlZnRDaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgYWxlcnQoXCJUaGVyZSBpcyBubyBzdWNoIGtleSFcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNIYXZlUm9vdChiaW5hcnlUcmVlOiBCaW5hcnlUcmVlKTogbnVsbCB7XHJcbiAgICAgICAgaWYgKGJpbmFyeVRyZWUucm9vdCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBhbGVydChcIlRoZSB0cmVlIGlzIG5vdCBpbml0aWFsaXplZCFcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgVHJlZU5vZGUgZnJvbSBcIi4vdHJlZS1ub2RlXCI7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRHJhd0hlbHBlciB7XHJcblxyXG4gICAgcHJpdmF0ZSBzcHJlYWRCeURlcHRoOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIHhQb3NGaXJzck5vZGU6IG51bWJlcjtcclxuICAgIHByaXZhdGUgeVBvc0FycjogbnVtYmVyW107XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMuc3ByZWFkQnlEZXB0aCA9IDI1MDtcclxuICAgICAgICB0aGlzLnhQb3NGaXJzck5vZGUgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDIgLSA2MDtcclxuICAgICAgICB0aGlzLnlQb3NBcnIgPSBbODAsIDE2MCwgMjQwLCAzMjAsIDQwMF07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRyYXdUcmVlKHJvb3Q6IFRyZWVOb2RlPHN0cmluZz4pOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB0ZW1wUG9zQXJyYXk6IG51bWJlcltdID0gW107XHJcbiAgICAgICAgbGV0IHBvc0FycmF5OiBudW1iZXJbXSA9IFtdO1xyXG4gICAgICAgIHBvc0FycmF5ID0gdGhpcy5jcmVhdGVQb3NBcnJheSh0aGlzLnhQb3NGaXJzck5vZGUsIHRoaXMueVBvc0Fyciwgcm9vdCwgdGVtcFBvc0FycmF5LCB0aGlzLnNwcmVhZEJ5RGVwdGgpO1xyXG5cclxuICAgICAgICBjb25zdCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzLW91dHB1dFwiKTtcclxuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgIGxldCBpOiBudW1iZXIgPSAwO1xyXG4gICAgICAgIHdoaWxlIChpIDwgcG9zQXJyYXkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAyO1xyXG4gICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBcIiNhYlwiO1xyXG4gICAgICAgICAgICBjdHguc3Ryb2tlUmVjdChwb3NBcnJheVtpICsgMV0sIHBvc0FycmF5W2kgKyAyXSwgNjAsIDMwKTtcclxuICAgICAgICAgICAgY3R4LmZvbnQgPSBcIjIwcHggR2VvcmdpYVwiO1xyXG4gICAgICAgICAgICBjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcclxuICAgICAgICAgICAgY3R4LmZpbGxUZXh0KGAke3Bvc0FycmF5W2ldfWAsIHBvc0FycmF5W2kgKyAxXSArIDMwLCBwb3NBcnJheVtpICsgMl0gKyAxNSk7XHJcbiAgICAgICAgICAgIGkgKz0gMztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVQb3NBcnJheSh3aWR0aDogbnVtYmVyLCB5UG9zQXJyOiBudW1iZXJbXSwgcm9vdDogVHJlZU5vZGU8c3RyaW5nPiwgcG9zQXJyYXk6IG51bWJlcltdLCBzcHJlYWRCeURlcHRoOiBudW1iZXIpOiBudW1iZXJbXSB7XHJcbiAgICAgICAgaWYgKHJvb3QgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcG9zQXJyYXkucHVzaChyb290LmtleSwgd2lkdGgsIHlQb3NBcnJbcm9vdC5kZXB0aExldmVsXSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlUG9zQXJyYXkod2lkdGggLSBzcHJlYWRCeURlcHRoLCB5UG9zQXJyLCByb290LmxlZnRDaGlsZCwgcG9zQXJyYXksIHNwcmVhZEJ5RGVwdGggLyAyKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVQb3NBcnJheSh3aWR0aCArIHNwcmVhZEJ5RGVwdGgsIHlQb3NBcnIsIHJvb3QucmlnaHRDaGlsZCwgcG9zQXJyYXksIHNwcmVhZEJ5RGVwdGggLyAyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHBvc0FycmF5O1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBCaW5hcnlUcmVlIGZyb20gXCIuL2JpbmFyeS10cmVlXCI7XHJcbmltcG9ydCBEcmF3SGVscGVyIGZyb20gXCIuL2RyYXctaGVscGVyXCI7XHJcbmltcG9ydCBUcmVlTm9kZSBmcm9tIFwiLi90cmVlLW5vZGVcIjtcclxuXHJcbmNvbnN0IGJpbmFyeVRyZWUgPSBuZXcgQmluYXJ5VHJlZTtcclxuY29uc3QgZHJhd0hlbHBlciA9IG5ldyBEcmF3SGVscGVyO1xyXG5jb25zdCBBRERfS0VZX0lEOiBzdHJpbmcgPSBcImVudHJ5LWZpZWxkX19rZXlcIjtcclxuY29uc3QgRVhUUl9LRVlfSUQ6IHN0cmluZyA9IFwiZW50cnktZmllbGRfX2V4dC1rZXlcIjtcclxuY29uc3QgREVMX0tFWV9JRDogc3RyaW5nID0gXCJlbnRyeS1maWVsZF9fZGVsZXRlLWtleVwiO1xyXG5cclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICAgICAgYWRkTm9kZTogRnVuY3Rpb247XHJcbiAgICAgICAgZXh0cmFjdGluZ05vZGU6IEZ1bmN0aW9uO1xyXG4gICAgICAgIGRlbGV0ZU5vZGU6IEZ1bmN0aW9uO1xyXG4gICAgICAgIG91dHB1dFRyZWU6IEZ1bmN0aW9uO1xyXG4gICAgICAgIGNsZWFyVHJlZTogRnVuY3Rpb247XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGtleUhlbHBlcihpZDogc3RyaW5nKTogbnVtYmVyIHwgbnVsbCB7XHJcbiAgICBjb25zdCBrZXk6IG51bWJlciA9IE51bWJlciggKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSApO1xyXG4gICAgaWYgKCBrZXkgPiA1MCB8fCBrZXkgPCAwIHx8IGtleSAlIDEgPiAwIHx8IE51bWJlci5pc05hTihrZXkpICkge1xyXG4gICAgICAgIGFsZXJ0KFwiSW52YWxpZCBrZXkgdmFsdWUhXCIpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgaWYgKGtleSA9PT0gMCkge1xyXG4gICAgICAgIGFsZXJ0KFwiTWlzc2luZyB2YWx1ZSBpbiBrZXkgZmllbGQhXCIpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGtleTtcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkTm9kZSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IGtleTogbnVtYmVyIHwgbnVsbCA9IGtleUhlbHBlcihBRERfS0VZX0lEKTtcclxuICAgIGlmIChrZXkgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YTogc3RyaW5nID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZW50cnktZmllbGRfX2RhdGFcIikgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWU7XHJcbiAgICBpZiAoZGF0YS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBhbGVydChcIk1pc3NpbmcgdmFsdWUgaW4gZGF0YSBmaWVsZCFcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKGRhdGEubGVuZ3RoID4gMTApIHtcclxuICAgICAgICBhbGVydChcIkludmFsaWQgZGF0YSBmaWVsZCBsZW5ndGghXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBiaW5hcnlUcmVlLmFkZE5vZGUoa2V5LCBkYXRhKTtcclxuICAgIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVudHJ5LWZpZWxkX19kYXRhXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlID0gXCJcIjtcclxuICAgIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChBRERfS0VZX0lEKSBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSA9IFwiXCI7XHJcbn1cclxuXHJcbndpbmRvdy5hZGROb2RlID0gYWRkTm9kZTtcclxuXHJcbmZ1bmN0aW9uIGV4dHJhY3RpbmdOb2RlKCk6IHZvaWQge1xyXG4gICAgaWYgKGJpbmFyeVRyZWUuaXNIYXZlUm9vdChiaW5hcnlUcmVlKSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBrZXk6IG51bWJlciB8IG51bGwgPSBrZXlIZWxwZXIoRVhUUl9LRVlfSUQpO1xyXG4gICAgaWYgKGtleSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXF1aXJlZE5vZGU6IFRyZWVOb2RlPHN0cmluZz4gfCBudWxsID0gYmluYXJ5VHJlZS5zZWFyY2hOb2RlQnlLZXkoa2V5LCBiaW5hcnlUcmVlLnJvb3QpO1xyXG4gICAgaWYgKHJlcXVpcmVkTm9kZSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGRhdGE6IHN0cmluZyA9IHJlcXVpcmVkTm9kZS5kYXRhO1xyXG4gICAgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwib3V0cHV0LWZpZWxkX19leHQta2V5XCIpIGFzIEhUTUxFbGVtZW50KS5pbm5lckhUTUwgPSBgRGF0YTogJHtyZXF1aXJlZE5vZGUuZGF0YX1gO1xyXG4gICAgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEVYVFJfS0VZX0lEKSBhcyBIVE1MSW5wdXRFbGVtZW50KS52YWx1ZSA9IFwiXCI7XHJcbn1cclxuXHJcbndpbmRvdy5leHRyYWN0aW5nTm9kZSA9IGV4dHJhY3RpbmdOb2RlO1xyXG5cclxuZnVuY3Rpb24gZGVsZXRlTm9kZSgpOiB2b2lkIHtcclxuICAgIGlmIChiaW5hcnlUcmVlLmlzSGF2ZVJvb3QoYmluYXJ5VHJlZSkgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qga2V5OiBudW1iZXIgfCBudWxsID0ga2V5SGVscGVyKERFTF9LRVlfSUQpO1xyXG4gICAgaWYgKGtleSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBiaW5hcnlUcmVlLnJlbW92ZUhlbHBlcihrZXksIGJpbmFyeVRyZWUucm9vdCk7XHJcbiAgICAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoREVMX0tFWV9JRCkgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUgPSBcIlwiO1xyXG59XHJcblxyXG53aW5kb3cuZGVsZXRlTm9kZSA9IGRlbGV0ZU5vZGU7XHJcblxyXG5cclxuZnVuY3Rpb24gb3V0cHV0VHJlZSgpOiB2b2lkIHtcclxuICAgIGlmIChiaW5hcnlUcmVlLmlzSGF2ZVJvb3QoYmluYXJ5VHJlZSkgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkcmF3SGVscGVyLmRyYXdUcmVlKGJpbmFyeVRyZWUucm9vdCk7XHJcbn1cclxuXHJcbndpbmRvdy5vdXRwdXRUcmVlID0gb3V0cHV0VHJlZTtcclxuXHJcblxyXG5mdW5jdGlvbiBjbGVhclRyZWUoKTogdm9pZCB7XHJcbiAgICBpZiAoYmluYXJ5VHJlZS5pc0hhdmVSb290KGJpbmFyeVRyZWUpID09PSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY2FudmFzID0gPEhUTUxDYW52YXNFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhcy1vdXRwdXRcIik7XHJcbiAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgYmluYXJ5VHJlZS5yb290ID0gbnVsbDtcclxufVxyXG5cclxud2luZG93LmNsZWFyVHJlZSA9IGNsZWFyVHJlZTtcclxuXHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCAoKSA9PiB7XHJcbiAgICBhbGVydChcIi0gTWF4aW11bSB0cmVlIGRlcHRoIChpbmNsdWRpbmcgcm9vdCk6IDUgbm9kZXMuXFxuXCIgK1xyXG4gICAgICAgIFwiLSBNYXhpbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIGZvciBkYXRhIGZpZWxkOiAxMCBjaGFyYWN0ZXJzLlxcblwiICtcclxuICAgICAgICBcIi0gS2V5cyBjYW4gb25seSBiZSBpbnRlZ2VycyB3aXRoIGEgdmFsdWUgb2Ygbm8gbW9yZSB0aGFuIDUwLlxcblwiKTtcclxufSk7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=